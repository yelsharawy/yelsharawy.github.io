<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" type="text/css" href="/style.css" />
  <title>Where do I park?</title>
  <script>
    function highlightCurrent() {
      let cells = document.querySelectorAll("#timetable tbody td");
      let now = new Date();
      let thisWeek = new Date()
        .setDate(now.getDate() - now.getDay())
      thisWeek -= thisWeek % (3600_000 * 24) - now.getTimezoneOffset() * 60_000;
      for (let cell of cells) {
        let from = thisWeek + cell.getAttribute("data-from") * 3600_000;
        let to = thisWeek + cell.getAttribute("data-to") * 3600_000;
        if (
             from <= now && now <= to
          || from + 3600_000 * 24 * 7 <= now
        ) {
          cell.classList.add("highlight");
        } else {
          cell.classList.remove("highlight");
        }
      }
      
      setTimeout(highlightCurrent, 60_000 - (now.getTime() % 60_000));
    }
    addEventListener("DOMContentLoaded", highlightCurrent);
  </script>
</head>

<body>
  <div class="content">
    <h1>Where do I park?</h1>
    <table id="timetable" cellspacing="0">
      <thead>
        <td>Away from house</td>
        <td>Next to house</td>
      </thead>
      <tbody>
        <tr>
          <td data-from="-6" data-to="43">Sat 6pm - Mon 7pm</td>
          <td data-from="42" data-to="67">Mon 6pm - Tues 7pm</td>
        </tr>
        <tr>
          <td data-from="66" data-to="91">Tues 6pm - Wed 7pm</td>
          <td data-from="91" data-to="115">Wed 6pm - Thurs 7pm</td>
        </tr>
        <tr>
          <td data-from="114" data-to="139">Thurs 6pm - Fri 7pm</td>
          <td data-from="139" data-to="163">Fri 6pm - Sat 7pm</td>
        </tr>
      </tbody>
    </table>
  </div>
</body>
</html>